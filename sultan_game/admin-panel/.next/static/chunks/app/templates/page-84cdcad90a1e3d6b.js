(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{1183:(e,t,a)=>{"use strict";a.d(t,{N:()=>m,d:()=>x});var s=a(5155),c=a(2115),n=a(9946);let r=(0,n.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),i=(0,n.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),l=(0,n.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),d=(0,n.A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),o=(0,n.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function p(e){let{message:t,onClose:a}=e,{id:n,type:p,title:m,message:x,duration:g=5e3}=t;(0,c.useEffect)(()=>{let e=setTimeout(()=>{a(n)},g);return()=>clearTimeout(e)},[n,g,a]);let h={success:(0,s.jsx)(r,{className:"w-5 h-5 text-green-500"}),error:(0,s.jsx)(i,{className:"w-5 h-5 text-red-500"}),warning:(0,s.jsx)(l,{className:"w-5 h-5 text-yellow-500"}),info:(0,s.jsx)(d,{className:"w-5 h-5 text-blue-500"})};return(0,s.jsxs)("div",{className:"flex items-start p-4 border rounded-lg shadow-lg ".concat({success:"bg-green-50 border-green-200",error:"bg-red-50 border-red-200",warning:"bg-yellow-50 border-yellow-200",info:"bg-blue-50 border-blue-200"}[p]," animate-in slide-in-from-top duration-300"),children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:h[p]}),(0,s.jsxs)("div",{className:"ml-3 flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:m}),x&&(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:x})]}),(0,s.jsx)("button",{onClick:()=>a(n),className:"ml-3 flex-shrink-0 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(o,{className:"w-4 h-4"})})]})}function m(e){let{messages:t,onClose:a}=e;return(0,s.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm",children:t.map(e=>(0,s.jsx)(p,{message:e,onClose:a},e.id))})}function x(){let[e,t]=(0,c.useState)([]),a=e=>{let a=Math.random().toString(36).substring(2,9);t(t=>[...t,{...e,id:a}])};return{messages:e,removeToast:e=>{t(t=>t.filter(t=>t.id!==e))},toast:{success:(e,t)=>a({type:"success",title:e,message:t}),error:(e,t)=>a({type:"error",title:e,message:t}),warning:(e,t)=>a({type:"warning",title:e,message:t}),info:(e,t)=>a({type:"info",title:e,message:t})}}}},2091:(e,t,a)=>{"use strict";a.d(t,{A:()=>N});var s=a(5155),c=a(6874),n=a.n(c),r=a(5695),i=a(7340),l=a(3578),d=a(7580),o=a(1586),p=a(9376),m=a(7434),x=a(2713),g=a(381);let h=[{name:"仪表盘",href:"/",icon:i.A},{name:"场景管理",href:"/scenes",icon:l.A},{name:"NPC管理",href:"/npcs",icon:d.A},{name:"卡片管理",href:"/cards",icon:o.A},{name:"AI配置",href:"/ai-configs",icon:p.A},{name:"配置模板",href:"/templates",icon:m.A},{name:"数据分析",href:"/analytics",icon:x.A},{name:"系统设置",href:"/settings",icon:g.A}];function u(){let e=(0,r.usePathname)();return(0,s.jsxs)("div",{className:"w-64 bg-gray-900 text-white min-h-screen",children:[(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-center",children:"苏丹的游戏"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 text-center mt-2",children:"管理后台"})]}),(0,s.jsx)("nav",{className:"mt-6",children:h.map(t=>{let a=e===t.href,c=t.icon;return(0,s.jsxs)(n(),{href:t.href,className:"flex items-center px-6 py-3 text-left hover:bg-gray-800 transition-colors ".concat(a?"bg-gray-800 border-r-4 border-blue-500":""),children:[(0,s.jsx)(c,{className:"w-5 h-5 mr-3"}),t.name]},t.name)})})]})}var f=a(7924),y=a(3861),b=a(1007);function j(){return(0,s.jsx)("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"搜索...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("button",{className:"p-2 text-gray-600 hover:text-gray-900 relative",children:[(0,s.jsx)(y.A,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full w-2 h-2"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:(0,s.jsx)(b.A,{className:"w-4 h-4 text-gray-600"})}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:"管理员"})]})]})]})})}function N(e){let{children:t}=e;return(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,s.jsx)(u,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(j,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:t})]})]})}},5731:(e,t,a)=>{"use strict";a.d(t,{BB:()=>r,ER:()=>n,Fw:()=>c,Pb:()=>i,hM:()=>l});let s=a(3464).A.create({baseURL:"",headers:{"Content-Type":"application/json"},timeout:1e4}),c={getScenes:()=>s.get("/api/scenes/"),getScene:e=>s.get("/api/scenes/".concat(e)),createScene:e=>s.post("/api/scenes/",e),updateScene:(e,t)=>s.put("/api/scenes/".concat(e),t),deleteScene:e=>s.delete("/api/scenes/".concat(e)),getSceneConfig:e=>s.get("/api/scenes/".concat(e,"/config")),getSceneNPCs:e=>s.get("/api/scenes/".concat(e,"/npcs")),addSceneNPC:(e,t)=>s.post("/api/scenes/".concat(e,"/npcs"),t),removeSceneNPC:(e,t)=>s.delete("/api/scenes/".concat(e,"/npcs/").concat(t)),getSceneRewards:e=>s.get("/api/scenes/".concat(e,"/rewards")),saveSceneRewards:(e,t)=>s.post("/api/scenes/".concat(e,"/rewards"),t),getSceneExtendedRewards:e=>s.get("/api/scenes/".concat(e,"/extended-rewards")),saveSceneExtendedRewards:(e,t)=>s.post("/api/scenes/".concat(e,"/extended-rewards"),t),getSceneRequirements:e=>s.get("/api/scenes/".concat(e,"/requirements")),saveSceneRequirements:(e,t)=>s.post("/api/scenes/".concat(e,"/requirements"),t),getSceneCardBindings:e=>s.get("/api/scenes/".concat(e,"/card-bindings")),addSceneCardBinding:(e,t)=>s.post("/api/scenes/".concat(e,"/card-bindings"),t),removeSceneCardBinding:(e,t)=>s.delete("/api/scenes/".concat(e,"/card-bindings/").concat(t)),getAvailableCards:()=>s.get("/api/cards/"),getAvailablePlayerNPCs:()=>s.get("/api/npcs/"),testScene:e=>s.post("/api/scenes/".concat(e,"/test"))},n={getNPCs:()=>s.get("/api/npcs/"),getNPC:e=>s.get("/api/npcs/".concat(e)),createNPC:e=>s.post("/api/npcs/",e),updateNPC:(e,t)=>s.put("/api/npcs/".concat(e),t),deleteNPC:e=>s.delete("/api/npcs/".concat(e))},r={getAIConfigs:()=>s.get("/api/ai-configs/"),getAIConfig:e=>s.get("/api/ai-configs/".concat(e)),createAIConfig:e=>s.post("/api/ai-configs/",e),updateAIConfig:(e,t)=>s.put("/api/ai-configs/".concat(e),t),deleteAIConfig:e=>s.delete("/api/ai-configs/".concat(e)),getAIPerformance:e=>s.get("/api/ai-configs/".concat(e,"/performance")),testAIConfig:(e,t)=>s.post("/api/ai-configs/".concat(e,"/test"),t),optimizeAIConfig:e=>s.post("/api/ai-configs/".concat(e,"/optimize")),getAITypes:()=>s.get("/api/ai-configs/types/enum")},i={getCards:()=>s.get("/api/cards/"),getCard:e=>s.get("/api/cards/".concat(e)),createCard:e=>s.post("/api/cards/",e),updateCard:(e,t)=>s.put("/api/cards/".concat(e),t),deleteCard:e=>s.delete("/api/cards/".concat(e))},l={getTemplates:e=>s.get("/api/templates/",{params:e}),getTemplate:e=>s.get("/api/templates/".concat(e)),createTemplate:e=>s.post("/api/templates/",e),updateTemplate:(e,t)=>s.put("/api/templates/".concat(e),t),deleteTemplate:e=>s.delete("/api/templates/".concat(e)),createFromScene:e=>s.post("/api/templates/from-scene",e),createFromAIConfig:(e,t,a)=>s.post("/api/templates/from-ai-config/".concat(e),null,{params:{template_name:t,description:a}}),applyToScene:(e,t)=>s.post("/api/templates/".concat(e,"/apply-to-scene/").concat(t)),getCategories:()=>s.get("/api/templates/categories/enum"),getTypes:()=>s.get("/api/templates/types/enum")}},7022:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(5155),c=a(2115),n=a(2091),r=a(1183),i=a(9946);let l=(0,i.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var d=a(7434),o=a(3717);let p=(0,i.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var m=a(2525),x=a(5731);function g(){let[e,t]=(0,c.useState)([]),[a,i]=(0,c.useState)(!0),[g,h]=(0,c.useState)(!1),[u,f]=(0,c.useState)(null),[y,b]=(0,c.useState)([]),[j,N]=(0,c.useState)([]),[v,w]=(0,c.useState)({template_id:"",name:"",template_type:"ai_config",category:"dialogue",description:"",author:"系统",template_data:{}}),{messages:A,removeToast:C,toast:k}=(0,r.d)();(0,c.useEffect)(()=>{S(),I(),P()},[]);let S=async()=>{try{let e=await x.hM.getTemplates();t(e.data)}catch(e){k.error("获取模板列表失败","请检查API服务是否正常运行")}finally{i(!1)}},I=async()=>{try{let e=await x.Fw.getScenes();b(e.data)}catch(e){console.error("获取场景列表失败:",e)}},P=async()=>{try{let e=await x.BB.getAIConfigs();N(e.data)}catch(e){console.error("获取AI配置列表失败:",e)}},_=async e=>{if(confirm("确定要删除这个模板吗？"))try{await x.hM.deleteTemplate(e.id),k.success("模板删除成功"),S()}catch(e){k.error("删除失败","请稍后重试")}},M=async e=>{var t;let a=(null==(t=y.find(t=>t.id===e))?void 0:t.name)||"未知场景",s=prompt("请输入模板名称:","".concat(a,"模板"));if(s)try{await x.hM.createFromScene({scene_id:e,template_name:s,description:"从场景 '".concat(a,"' 生成的模板")}),k.success("模板创建成功","已从场景生成新模板"),S()}catch(e){k.error("创建模板失败","请稍后重试")}},T=async e=>{var t;let a=(null==(t=j.find(t=>t.id===e))?void 0:t.name)||"未知配置",s=prompt("请输入模板名称:","".concat(a,"模板"));if(s)try{await x.hM.createFromAIConfig(e,s,"从AI配置 '".concat(a,"' 生成的模板")),k.success("模板创建成功","已从AI配置生成新模板"),S()}catch(e){k.error("创建模板失败","请稍后重试")}};return(0,s.jsxs)(n.A,{children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"配置模板"}),(0,s.jsx)("p",{className:"text-gray-600",children:"管理AI配置和场景的预设模板"})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)("button",{className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[(0,s.jsx)(l,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"导入模板"})]}),(0,s.jsxs)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[(0,s.jsx)(d.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"新建模板"})]})]})]}),a?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"加载中..."})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{var t;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)(d.A,{className:"w-8 h-8 text-blue-500"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["使用 ",e.usage_count," 次"]})]}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mb-4",children:["作者: ",e.author," | 版本: ",e.version]}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat({dialogue:"bg-blue-100 text-blue-800",combat:"bg-red-100 text-red-800",political:"bg-purple-100 text-purple-800",economic:"bg-green-100 text-green-800",stealth:"bg-gray-100 text-gray-800",social:"bg-pink-100 text-pink-800"}[e.category]||"bg-gray-100 text-gray-800"),children:e.category}),(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:{scene:"场景模板",ai_config:"AI配置模板",npc_config:"NPC配置模板",composite:"复合模板"}[t=e.template_type]||t})]})}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>k.info("编辑功能","编辑模板功能开发中"),className:"text-blue-600 hover:text-blue-900",title:"编辑",children:(0,s.jsx)(o.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>k.info("导出功能","导出模板功能开发中"),className:"text-green-600 hover:text-green-900",title:"导出",children:(0,s.jsx)(p,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>_(e),className:"text-red-600 hover:text-red-900",title:"删除",children:(0,s.jsx)(m.A,{className:"w-4 h-4"})})]})]},e.id)})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"快速操作"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"从现有场景生成模板"}),(0,s.jsxs)("select",{onChange:e=>e.target.value&&M(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg",defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"选择场景..."}),y.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"从AI配置生成模板"}),(0,s.jsxs)("select",{onChange:e=>e.target.value&&T(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg",defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"选择AI配置..."}),j.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})]})]}),(0,s.jsx)(r.N,{messages:A,onClose:C})]})}},9780:(e,t,a)=>{Promise.resolve().then(a.bind(a,7022))}},e=>{e.O(0,[291,488,441,964,358],()=>e(e.s=9780)),_N_E=e.O()}]);