(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{1539:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},2091:(e,t,a)=>{"use strict";a.d(t,{A:()=>j});var s=a(5155),n=a(6874),c=a.n(n),r=a(5695),i=a(7340),l=a(3578),o=a(7580),d=a(1586),p=a(9376),m=a(7434),g=a(2713),x=a(381);let u=[{name:"仪表盘",href:"/",icon:i.A},{name:"场景管理",href:"/scenes",icon:l.A},{name:"NPC管理",href:"/npcs",icon:o.A},{name:"卡片管理",href:"/cards",icon:d.A},{name:"AI配置",href:"/ai-configs",icon:p.A},{name:"配置模板",href:"/templates",icon:m.A},{name:"数据分析",href:"/analytics",icon:g.A},{name:"系统设置",href:"/settings",icon:x.A}];function f(){let e=(0,r.usePathname)();return(0,s.jsxs)("div",{className:"w-64 bg-gray-900 text-white min-h-screen",children:[(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-center",children:"苏丹的游戏"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 text-center mt-2",children:"管理后台"})]}),(0,s.jsx)("nav",{className:"mt-6",children:u.map(t=>{let a=e===t.href,n=t.icon;return(0,s.jsxs)(c(),{href:t.href,className:"flex items-center px-6 py-3 text-left hover:bg-gray-800 transition-colors ".concat(a?"bg-gray-800 border-r-4 border-blue-500":""),children:[(0,s.jsx)(n,{className:"w-5 h-5 mr-3"}),t.name]},t.name)})})]})}var h=a(7924),y=a(3861),b=a(1007);function N(){return(0,s.jsx)("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,s.jsx)("input",{type:"text",placeholder:"搜索...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("button",{className:"p-2 text-gray-600 hover:text-gray-900 relative",children:[(0,s.jsx)(y.A,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full w-2 h-2"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:(0,s.jsx)(b.A,{className:"w-4 h-4 text-gray-600"})}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:"管理员"})]})]})]})})}function j(e){let{children:t}=e;return(0,s.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,s.jsx)(f,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(N,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:t})]})]})}},4616:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4727:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(5155),n=a(2115),c=a(2091),r=a(4616),i=a(3717);let l=(0,a(9946).A)("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);var o=a(1539),d=a(2713),p=a(2525),m=a(5731);function g(){let[e,t]=(0,n.useState)([]),[a,g]=(0,n.useState)(!0),[x,u]=(0,n.useState)(!1),[f,h]=(0,n.useState)(null),[y,b]=(0,n.useState)([]),[N,j]=(0,n.useState)({config_id:"",name:"",ai_type:"narrator",base_prompt:"",system_prompt:"",model_config:'{"temperature": 0.7, "max_tokens": 1000}',character_config:"{}",evaluation_config:"{}",generation_config:"{}",narration_config:"{}",version:"1.0",created_by:"admin"});(0,n.useEffect)(()=>{v(),_()},[]);let v=async()=>{try{let e=await m.BB.getAIConfigs();t(e.data)}catch(e){console.error("获取AI配置列表失败:",e),alert("获取AI配置列表失败，请检查API服务是否正常运行")}finally{g(!1)}},_=async()=>{try{let e=await m.BB.getAITypes();b(e.data.ai_types)}catch(e){console.error("获取AI类型失败:",e),b(["narrator","npc","evaluator","option_generator"])}},w=async e=>{e.preventDefault();try{let e={...N,model_config:JSON.parse(N.model_config),character_config:JSON.parse(N.character_config),evaluation_config:JSON.parse(N.evaluation_config),generation_config:JSON.parse(N.generation_config),narration_config:JSON.parse(N.narration_config)};f?(await m.BB.updateAIConfig(f.id,e),alert("AI配置更新成功")):(await m.BB.createAIConfig(e),alert("AI配置创建成功")),u(!1),h(null),k(),v()}catch(e){console.error("操作失败:",e),alert("操作失败，请检查输入的JSON格式是否正确")}},A=async e=>{if(confirm('确定要删除AI配置 "'.concat(e.name,'" 吗？')))try{await m.BB.deleteAIConfig(e.id),alert("AI配置删除成功"),v()}catch(e){console.error("删除失败:",e),alert("删除失败")}},C=async e=>{try{let t=await m.BB.testAIConfig(e.id,{prompt:"这是一个测试提示词"});alert("测试成功！\n响应时间: ".concat(t.data.response_time_ms,"ms\n使用Token: ").concat(t.data.tokens_used,"\n响应: ").concat(t.data.response_text))}catch(e){console.error("测试失败:",e),alert("测试失败")}},S=async e=>{try{let t=await m.BB.optimizeAIConfig(e.id);alert("优化成功！\n".concat(t.data.message,"\n优化内容:\n").concat(t.data.optimizations.join("\n")))}catch(e){console.error("优化失败:",e),alert("优化失败")}},k=()=>{j({config_id:"",name:"",ai_type:"narrator",base_prompt:"",system_prompt:"",model_config:'{"temperature": 0.7, "max_tokens": 1000}',character_config:"{}",evaluation_config:"{}",generation_config:"{}",narration_config:"{}",version:"1.0",created_by:"admin"})},I=e=>({narrator:"旁白",npc:"NPC角色",evaluator:"评估",option_generator:"选项生成"})[e]||e;return a?(0,s.jsx)(c.A,{children:(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"text-lg text-gray-600",children:"加载中..."})})}):(0,s.jsx)(c.A,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"AI配置管理"}),(0,s.jsx)("p",{className:"text-gray-600",children:"管理游戏AI配置和模型参数"})]}),(0,s.jsxs)("button",{onClick:()=>{h(null),k(),u(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[(0,s.jsx)(r.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"新建配置"})]})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"配置信息"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"类型"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"版本"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"状态"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"操作"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.config_id]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 mt-1 truncate max-w-xs",children:e.base_prompt})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"text-sm text-gray-900",children:I(e.ai_type)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.version}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.is_active?"活跃":"禁用"})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{h(e),j({config_id:e.config_id,name:e.name,ai_type:e.ai_type,base_prompt:e.base_prompt,system_prompt:e.system_prompt||"",model_config:JSON.stringify(e.model_config||{},null,2),character_config:JSON.stringify(e.character_config||{},null,2),evaluation_config:JSON.stringify(e.evaluation_config||{},null,2),generation_config:JSON.stringify(e.generation_config||{},null,2),narration_config:JSON.stringify(e.narration_config||{},null,2),version:e.version,created_by:e.created_by||"admin"}),u(!0)},className:"text-blue-600 hover:text-blue-900",title:"编辑",children:(0,s.jsx)(i.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>C(e),className:"text-green-600 hover:text-green-900",title:"测试",children:(0,s.jsx)(l,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>S(e),className:"text-purple-600 hover:text-purple-900",title:"优化",children:(0,s.jsx)(o.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>alert("性能分析功能开发中"),className:"text-yellow-600 hover:text-yellow-900",title:"性能分析",children:(0,s.jsx)(d.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>A(e),className:"text-red-600 hover:text-red-900",title:"删除",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})})]})]},e.id))})]})}),x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:f?"编辑AI配置":"新建AI配置"}),(0,s.jsxs)("form",{onSubmit:w,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"配置ID"}),(0,s.jsx)("input",{type:"text",value:N.config_id,onChange:e=>j({...N,config_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!f})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"配置名称"}),(0,s.jsx)("input",{type:"text",value:N.name,onChange:e=>j({...N,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"AI类型"}),(0,s.jsx)("select",{value:N.ai_type,onChange:e=>j({...N,ai_type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:y.map(e=>(0,s.jsx)("option",{value:e,children:I(e)},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"版本"}),(0,s.jsx)("input",{type:"text",value:N.version,onChange:e=>j({...N,version:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"基础提示词"}),(0,s.jsx)("textarea",{value:N.base_prompt,onChange:e=>j({...N,base_prompt:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"系统提示词"}),(0,s.jsx)("textarea",{value:N.system_prompt,onChange:e=>j({...N,system_prompt:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"模型设置 (JSON)"}),(0,s.jsx)("textarea",{value:N.model_config,onChange:e=>j({...N,model_config:e.target.value}),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:'{"temperature": 0.7, "max_tokens": 1000}'})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"角色配置 (JSON)"}),(0,s.jsx)("textarea",{value:N.character_config,onChange:e=>j({...N,character_config:e.target.value}),rows:5,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"{}"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"取消"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:f?"更新":"创建"})]})]})]})})]})})}},5731:(e,t,a)=>{"use strict";a.d(t,{BB:()=>r,ER:()=>c,Fw:()=>n,Pb:()=>i,hM:()=>l});let s=a(3464).A.create({baseURL:"",headers:{"Content-Type":"application/json"},timeout:1e4}),n={getScenes:()=>s.get("/api/scenes/"),getScene:e=>s.get("/api/scenes/".concat(e)),createScene:e=>s.post("/api/scenes/",e),updateScene:(e,t)=>s.put("/api/scenes/".concat(e),t),deleteScene:e=>s.delete("/api/scenes/".concat(e)),getSceneConfig:e=>s.get("/api/scenes/".concat(e,"/config")),getSceneNPCs:e=>s.get("/api/scenes/".concat(e,"/npcs")),addSceneNPC:(e,t)=>s.post("/api/scenes/".concat(e,"/npcs"),t),removeSceneNPC:(e,t)=>s.delete("/api/scenes/".concat(e,"/npcs/").concat(t)),getSceneRewards:e=>s.get("/api/scenes/".concat(e,"/rewards")),saveSceneRewards:(e,t)=>s.post("/api/scenes/".concat(e,"/rewards"),t),getSceneExtendedRewards:e=>s.get("/api/scenes/".concat(e,"/extended-rewards")),saveSceneExtendedRewards:(e,t)=>s.post("/api/scenes/".concat(e,"/extended-rewards"),t),getSceneRequirements:e=>s.get("/api/scenes/".concat(e,"/requirements")),saveSceneRequirements:(e,t)=>s.post("/api/scenes/".concat(e,"/requirements"),t),getSceneCardBindings:e=>s.get("/api/scenes/".concat(e,"/card-bindings")),addSceneCardBinding:(e,t)=>s.post("/api/scenes/".concat(e,"/card-bindings"),t),removeSceneCardBinding:(e,t)=>s.delete("/api/scenes/".concat(e,"/card-bindings/").concat(t)),getAvailableCards:()=>s.get("/api/cards/"),getAvailablePlayerNPCs:()=>s.get("/api/npcs/"),testScene:e=>s.post("/api/scenes/".concat(e,"/test"))},c={getNPCs:()=>s.get("/api/npcs/"),getNPC:e=>s.get("/api/npcs/".concat(e)),createNPC:e=>s.post("/api/npcs/",e),updateNPC:(e,t)=>s.put("/api/npcs/".concat(e),t),deleteNPC:e=>s.delete("/api/npcs/".concat(e))},r={getAIConfigs:()=>s.get("/api/ai-configs/"),getAIConfig:e=>s.get("/api/ai-configs/".concat(e)),createAIConfig:e=>s.post("/api/ai-configs/",e),updateAIConfig:(e,t)=>s.put("/api/ai-configs/".concat(e),t),deleteAIConfig:e=>s.delete("/api/ai-configs/".concat(e)),getAIPerformance:e=>s.get("/api/ai-configs/".concat(e,"/performance")),testAIConfig:(e,t)=>s.post("/api/ai-configs/".concat(e,"/test"),t),optimizeAIConfig:e=>s.post("/api/ai-configs/".concat(e,"/optimize")),getAITypes:()=>s.get("/api/ai-configs/types/enum")},i={getCards:()=>s.get("/api/cards/"),getCard:e=>s.get("/api/cards/".concat(e)),createCard:e=>s.post("/api/cards/",e),updateCard:(e,t)=>s.put("/api/cards/".concat(e),t),deleteCard:e=>s.delete("/api/cards/".concat(e))},l={getTemplates:e=>s.get("/api/templates/",{params:e}),getTemplate:e=>s.get("/api/templates/".concat(e)),createTemplate:e=>s.post("/api/templates/",e),updateTemplate:(e,t)=>s.put("/api/templates/".concat(e),t),deleteTemplate:e=>s.delete("/api/templates/".concat(e)),createFromScene:e=>s.post("/api/templates/from-scene",e),createFromAIConfig:(e,t,a)=>s.post("/api/templates/from-ai-config/".concat(e),null,{params:{template_name:t,description:a}}),applyToScene:(e,t)=>s.post("/api/templates/".concat(e,"/apply-to-scene/").concat(t)),getCategories:()=>s.get("/api/templates/categories/enum"),getTypes:()=>s.get("/api/templates/types/enum")}},6107:(e,t,a)=>{Promise.resolve().then(a.bind(a,4727))}},e=>{e.O(0,[291,488,441,964,358],()=>e(e.s=6107)),_N_E=e.O()}]);